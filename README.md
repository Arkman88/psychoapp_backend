# PsychoApp Server

Django REST API —Å–µ—Ä–≤–µ—Ä –¥–ª—è –º–æ–±–∏–ª—å–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è PsychoApp —Å —Ñ—É–Ω–∫—Ü–∏—è–º–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏, –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π —Å AI —Å–µ—Ä–≤–∏—Å–∞–º–∏.

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- ‚úÖ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∏ –≤—Ö–æ–¥ —á–µ—Ä–µ–∑ Email/Password
- ‚úÖ OAuth –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è (Google, Yandex, VK)
- ‚úÖ JWT —Ç–æ–∫–µ–Ω—ã –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
- ‚úÖ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- ‚úÖ PostgreSQL –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å AI —Å–µ—Ä–≤–∏—Å–∞–º–∏ (Yandex GPT, ChatGPT, DeepSeek)
- ‚úÖ **873 —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è** —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏ –∏ –º—É–ª—å—Ç–∏—è–∑—ã—á–Ω–æ–π –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π
- ‚úÖ **Fuzzy matching** –¥–ª—è —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π –≥–æ–ª–æ—Å–æ–º/—Ç–µ–∫—Å—Ç–æ–º
- ‚úÖ **–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –ø–µ—Ä–µ–≤–æ–¥** —á–µ—Ä–µ–∑ Yandex Cloud Translate API

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### –°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π
- **[EXERCISE_SYSTEM_README.md](EXERCISE_SYSTEM_README.md)** - –ü–æ–ª–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π –∏ API
- **[TRANSLATION_README.md](TRANSLATION_README.md)** - –ü–µ—Ä–µ–≤–æ–¥ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π –Ω–∞ —Ä—É—Å—Å–∫–∏–π
- **[EXERCISE_MATCHING_README.md](EXERCISE_MATCHING_README.md)** - –ê–ª–≥–æ—Ä–∏—Ç–º—ã —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è

### –ë—ã—Å—Ç—Ä–æ–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ (NEW! üÜï)
- **[QUICK_MATCH_SUMMARY.md](QUICK_MATCH_SUMMARY.md)** - –°–≤–æ–¥–∫–∞ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã
- **[EXERCISE_QUICK_MATCH_README.md](EXERCISE_QUICK_MATCH_README.md)** - –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- **[QUICK_MATCH_INTEGRATION.md](QUICK_MATCH_INTEGRATION.md)** - –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è —Ñ—Ä–æ–Ω—Ç–∞

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç: –†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π

### Backend (—É–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç!)

```bash
# API endpoint –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é
POST /api/exercises/quick-match/
```

**–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞:**
```bash
curl -X POST http://localhost:8000/api/exercises/quick-match/ \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{"text":"–∂–∏–º –ª–µ–∂–∞","language":"ru","max_results":3}'
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "matches": [
    {
      "id": "uuid",
      "name": "Barbell Bench Press",
      "name_ru": "–ñ–∏–º —à—Ç–∞–Ω–≥–∏ –ª—ë–∂–∞",
      "similarity": 0.95,
      "image_main": "/media/exercises/...",
      ...
    }
  ],
  "exact_match": true,
  "processing_time_ms": 45
}
```

### Frontend (React Native)

1. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Voice Recognition:**
```bash
npm install @react-native-voice/voice
```

2. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å API:**
```typescript
import { quickMatchExercise } from './services/exerciseQuickMatch';

const result = await quickMatchExercise("–∂–∏–º –ª–µ–∂–∞", "ru");

if (result.exact_match) {
  // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–±—Ä–∞—Ç—å
  selectExercise(result.matches[0]);
} else {
  // –ü–æ–∫–∞–∑–∞—Ç—å 1-3 –∫–∞—Ä—Ç–æ—á–∫–∏ –Ω–∞ –≤—ã–±–æ—Ä
  showExerciseCards(result.matches);
}
```

üìñ **–ü–æ–¥—Ä–æ–±–Ω–µ–µ:** [QUICK_MATCH_INTEGRATION.md](QUICK_MATCH_INTEGRATION.md)

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

1. –°–æ–∑–¥–∞–π—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ:
```bash
python -m venv .venv
source .venv/bin/activate  # macOS/Linux
# –∏–ª–∏ .venv\Scripts\activate –Ω–∞ Windows
```

2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
```bash
pip install -r requirements.txt
```

3. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ PostgreSQL:
```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ PostgreSQL (macOS)
brew install postgresql
brew services start postgresql

# –°–æ–∑–¥–∞–π—Ç–µ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
createdb psychoapp_db
```

4. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:
```bash
cp .env.example .env
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ .env —Ñ–∞–π–ª —Å –≤–∞—à–∏–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏
```

5. –í—ã–ø–æ–ª–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏:
```bash
python manage.py makemigrations
python manage.py migrate
```

6. –°–æ–∑–¥–∞–π—Ç–µ —Å—É–ø–µ—Ä–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
```bash
python manage.py createsuperuser
```

7. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä:
```bash
python manage.py runserver
```

## –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

### –û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
- `SECRET_KEY` - —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á Django
- `DEBUG` - —Ä–µ–∂–∏–º –æ—Ç–ª–∞–¥–∫–∏ (True/False)
- `ALLOWED_HOSTS` - —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ —Ö–æ—Å—Ç—ã

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö PostgreSQL
- `DB_ENGINE` - django.db.backends.postgresql
- `DB_NAME` - –∏–º—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (psychoapp_db)
- `DB_USER` - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å PostgreSQL
- `DB_PASSWORD` - –ø–∞—Ä–æ–ª—å PostgreSQL
- `DB_HOST` - —Ö–æ—Å—Ç (localhost)
- `DB_PORT` - –ø–æ—Ä—Ç (5432)

### OAuth –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã
- `GOOGLE_OAUTH_CLIENT_ID` - Google OAuth Client ID
- `GOOGLE_OAUTH_CLIENT_SECRET` - Google OAuth Client Secret
- `YANDEX_CLIENT_ID` - Yandex OAuth Client ID
- `YANDEX_CLIENT_SECRET` - Yandex OAuth Client Secret

### AI API –∫–ª—é—á–∏
- `YANDEX_GPT_API_KEY` - API –∫–ª—é—á Yandex GPT
- `YANDEX_GPT_FOLDER_ID` - ID –ø–∞–ø–∫–∏ Yandex Cloud
- `CHATGPT_API_KEY` - API –∫–ª—é—á OpenAI (ChatGPT)
- `DEEPSEEK_API_KEY` - API –∫–ª—é—á DeepSeek

## API Endpoints

### –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
- **POST** `/api/auth/register/`
  ```json
  {
    "email": "user@example.com",
    "password": "SecurePassword123",
    "display_name": "–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤"
  }
  ```

### –í—Ö–æ–¥
- **POST** `/api/auth/login/`
  ```json
  {
    "email": "user@example.com",
    "password": "SecurePassword123"
  }
  ```

### OAuth –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

#### Google
- **POST** `/api/auth/google/`
  ```json
  {
    "provider": "google",
    "id_token": "google_id_token_here",
    "email": "user@gmail.com",
    "display_name": "User Name",
    "photo_url": "https://..."
  }
  ```

#### Yandex
- **POST** `/api/auth/yandex/`
  ```json
  {
    "provider": "yandex",
    "access_token": "yandex_access_token"
  }
  ```

#### VK
- **POST** `/api/auth/vk/`
  ```json
  {
    "provider": "vk",
    "user": {
      "id": 123456,
      "first_name": "–ò–≤–∞–Ω",
      "last_name": "–ò–≤–∞–Ω–æ–≤",
      "email": "user@vk.com"
    }
  }
  ```

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞
- **POST** `/api/auth/refresh/`
  ```json
  {
    "refresh": "refresh_token_here"
  }
  ```

### –ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- **GET** `/api/auth/me/`
  - Headers: `Authorization: Bearer <access_token>`

- **PUT/PATCH** `/api/auth/me/`
  ```json
  {
    "display_name": "–ù–æ–≤–æ–µ –ò–º—è",
    "phone_number": "+7 999 123 45 67",
    "age": 25,
    "gender": "male",
    "country": "Russia",
    "language": "ru"
  }
  ```

### –°–º–µ–Ω–∞ –ø–∞—Ä–æ–ª—è
- **POST** `/api/auth/change-password/`
  ```json
  {
    "old_password": "OldPassword123",
    "new_password": "NewPassword123"
  }
  ```

### –°–±—Ä–æ—Å –ø–∞—Ä–æ–ª—è
- **POST** `/api/auth/reset-password/`
  ```json
  {
    "email": "user@example.com"
  }
  ```

### –í—ã—Ö–æ–¥
- **POST** `/api/auth/logout/`
  - Headers: `Authorization: Bearer <access_token>`
  ```json
  {
    "refresh": "refresh_token_here"
  }
  ```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
ServerPsychoApp/
‚îú‚îÄ‚îÄ config/                 # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞
‚îÇ   ‚îú‚îÄ‚îÄ settings.py        # –û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Django
‚îÇ   ‚îú‚îÄ‚îÄ urls.py            # –ì–ª–∞–≤–Ω—ã–µ URL –º–∞—Ä—à—Ä—É—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ ai_config.py       # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è AI —Å–µ—Ä–≤–∏—Å–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ wsgi.py
‚îú‚îÄ‚îÄ authentication/         # –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ models.py          # –ú–æ–¥–µ–ª–∏ User, UserSession
‚îÇ   ‚îú‚îÄ‚îÄ serializers.py     # –°–µ—Ä–∏–∞–ª–∏–∑–∞—Ç–æ—Ä—ã
‚îÇ   ‚îú‚îÄ‚îÄ views.py           # API views
‚îÇ   ‚îú‚îÄ‚îÄ urls.py            # URL –º–∞—Ä—à—Ä—É—Ç—ã
‚îÇ   ‚îî‚îÄ‚îÄ admin.py           # –ê–¥–º–∏–Ω–∫–∞
‚îú‚îÄ‚îÄ manage.py
‚îú‚îÄ‚îÄ requirements.txt
‚îú‚îÄ‚îÄ .env                   # –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (–Ω–µ –≤ git)
‚îú‚îÄ‚îÄ .env.example          # –ü—Ä–∏–º–µ—Ä –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ .gitignore
‚îî‚îÄ‚îÄ README.md
```

## –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö

### User (–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å)
- `id` - UUID (–ø–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á)
- `email` - Email (—É–Ω–∏–∫–∞–ª—å–Ω—ã–π)
- `display_name` - –û—Ç–æ–±—Ä–∞–∂–∞–µ–º–æ–µ –∏–º—è
- `photo_url` - URL —Ñ–æ—Ç–æ –ø—Ä–æ—Ñ–∏–ª—è
- `provider` - –ü—Ä–æ–≤–∞–π–¥–µ—Ä –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ (email/google/yandex/vk)
- `provider_id` - ID –≤ —Å–∏—Å—Ç–µ–º–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞
- `phone_number` - –ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞
- `email_verified` - Email –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω
- `age` - –í–æ–∑—Ä–∞—Å—Ç
- `gender` - –ü–æ–ª
- `country` - –°—Ç—Ä–∞–Ω–∞
- `language` - –Ø–∑—ã–∫
- `timezone` - –ß–∞—Å–æ–≤–æ–π –ø–æ—è—Å
- `notifications_enabled` - –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤–∫–ª—é—á–µ–Ω—ã
- `biometric_enabled` - –ë–∏–æ–º–µ—Ç—Ä–∏—è –≤–∫–ª—é—á–µ–Ω–∞
- `theme` - –¢–µ–º–∞ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è
- `created_at` - –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è
- `updated_at` - –î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
- `last_login_at` - –ü–æ—Å–ª–µ–¥–Ω–∏–π –≤—Ö–æ–¥

### UserSession (–°–µ—Å—Å–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è)
- `user` - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å (FK)
- `device_id` - ID —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
- `device_type` - –¢–∏–ø —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ (ios/android)
- `device_name` - –ù–∞–∑–≤–∞–Ω–∏–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
- `ip_address` - IP –∞–¥—Ä–µ—Å
- `user_agent` - User Agent
- `refresh_token` - Refresh —Ç–æ–∫–µ–Ω
- `is_active` - –ê–∫—Ç–∏–≤–Ω–∞
- `created_at` - –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è
- `last_activity` - –ü–æ—Å–ª–µ–¥–Ω—è—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å

## –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- Django 5.0
- Django REST Framework
- JWT Authentication (Simple JWT)
- PostgreSQL
- CORS Headers
- Python Decouple

## –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –°–æ–∑–¥–∞–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π
```bash
python manage.py makemigrations
python manage.py migrate
```

### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤
```bash
python test_api.py
```

### –î–æ—Å—Ç—É–ø –∫ –∞–¥–º–∏–Ω–∫–µ
```
http://localhost:8000/admin/
```

## –î–µ–ø–ª–æ–π

–î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞:
1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ `DEBUG=False`
2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ `ALLOWED_HOSTS`
3. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–∏–ª—å–Ω—ã–π `SECRET_KEY`
4. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ PostgreSQL
5. –°–æ–±–µ—Ä–∏—Ç–µ —Å—Ç–∞—Ç–∏–∫—É: `python manage.py collectstatic`
6. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Gunicorn + Nginx
7. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ HTTPS
8. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ CORS –¥–ª—è –≤–∞—à–µ–≥–æ –¥–æ–º–µ–Ω–∞

## –õ–∏—Ü–µ–Ω–∑–∏—è

MIT
